(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{2601:function(t,e,r){"use strict";var n,a;t.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(a=r.g.process)?void 0:a.env)?r.g.process:r(8960)},3600:function(t,e,r){Promise.resolve().then(r.t.bind(r,2445,23)),Promise.resolve().then(r.bind(r,8372)),Promise.resolve().then(r.bind(r,4640)),Promise.resolve().then(r.t.bind(r,6621,23))},8372:function(t,e,r){"use strict";r.r(e),r.d(e,{CartProvider:function(){return i},useCart:function(){return s}});var n=r(7437),a=r(2265);r(9487);let o=(0,a.createContext)();function i(t){let{children:e}=t,[r,i]=(0,a.useState)([]),s=t=>{i(e=>e.filter(e=>e.cartId!==t))};return(0,n.jsx)(o.Provider,{value:{items:r,addItem:t=>{let e=t.stock_quantity||t.stock||0;i(r=>{let n=r.find(e=>e.id===t.id&&e.selectedSize===t.selectedSize),a=t.quantity||1;if(n){let o=n.quantity+a;return o>e?(alert("Cannot add more items. Only ".concat(e," in stock. You already have ").concat(n.quantity," in your cart.")),r):r.map(e=>e.id===t.id&&e.selectedSize===t.selectedSize?{...e,quantity:o}:e)}if(a>e)return alert("Cannot add ".concat(a," items. Only ").concat(e," in stock.")),r;let o="".concat(t.id,"_").concat(t.selectedSize||"nosize","_").concat(Date.now());return[...r,{...t,quantity:a,cartId:o}]})},updateQuantity:(t,e)=>{if(e<=0){s(t);return}i(r=>{let n=r.find(e=>e.cartId===t);if(!n)return r;let a=n.stock_quantity||n.stock||0;return e>a?(alert("Cannot set quantity to ".concat(e,". Only ").concat(a," in stock.")),r):r.map(r=>r.cartId===t?{...r,quantity:e}:r)})},removeItem:s,clearCart:()=>{i([])},getTotal:()=>r.reduce((t,e)=>t+parseFloat(e.price.toString().replace(/[^0-9.]/g,""))*e.quantity,0).toFixed(2)},children:e})}function s(){let t=(0,a.useContext)(o);if(!t)throw Error("useCart must be used within a CartProvider");return t}},4640:function(t,e,r){"use strict";r.r(e),r.d(e,{AuthProvider:function(){return s},useAuth:function(){return c}});var n=r(7437),a=r(2265),o=r(9487);let i=(0,a.createContext)();function s(t){let{children:e}=t,[r,s]=(0,a.useState)(null),[c,u]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{try{if(o.Z.getToken()){let t=await o.Z.getCurrentUser();s(t)}}catch(t){console.error("Auth check failed:",t),o.Z.logout()}finally{u(!1)}})()},[]);let l=async(t,e)=>{try{await o.Z.login(t,e);let r=await o.Z.getCurrentUser();return s(r),{success:!0,user:r}}catch(t){throw t}},d=async t=>{try{let e=await o.Z.register(t);return{success:!0,data:e}}catch(t){throw t}},y=async()=>{try{await o.Z.logout(),s(null)}catch(t){console.error("Logout error:",t)}};return(0,n.jsx)(i.Provider,{value:{user:r,isLoading:c,login:l,register:d,logout:y,isAuthenticated:!!r},children:e})}function c(){let t=(0,a.useContext)(i);if(!t)throw Error("useAuth must be used within an AuthProvider");return t}},9487:function(t,e,r){"use strict";let n=r(2601).env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000";class a{setToken(t){this.token=t,t?localStorage.setItem("auth_token",t):localStorage.removeItem("auth_token")}getToken(){return this.token?this.token:localStorage.getItem("auth_token")}async request(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="".concat(this.baseURL).concat(t),n=this.getToken(),a={headers:{"Content-Type":"application/json",...e.headers},...e};n&&(a.headers.Authorization="Bearer ".concat(n));try{let t=await fetch(r,a),e=await t.json();if(!t.ok){let t="API request failed";throw e.detail?t=Array.isArray(e.detail)?e.detail.map(t=>t.msg).join(", "):e.detail:e.message&&(t=e.message),Error(t)}return e}catch(t){throw console.error("API Error:",t),t}}async login(t,e){try{let r=await this.request("/api/v1/auth/login",{method:"POST",body:JSON.stringify({email:t,password:e})});return r.access_token&&this.setToken(r.access_token),r}catch(t){throw console.error("Login API error:",t),t}}async register(t){return await this.request("/api/v1/auth/register",{method:"POST",body:JSON.stringify(t)})}async logout(){this.setToken(null)}async getCurrentUser(){return await this.request("/api/v1/auth/me")}async getProducts(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new URLSearchParams(t).toString();return await this.request("/api/v1/products-fixed?".concat(e))}async getAllProducts(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new URLSearchParams(t).toString(),r=await this.request("/api/v1/products/".concat(e?"?"+e:""));return r.items?{data:r.items.map(t=>({...t,status:t.status?t.status.replace("ProductStatus.","").toLowerCase():"draft",category:t.category?t.category.replace("Category.",""):t.category})),...r}:r}async getProduct(t){return await this.request("/api/v1/products/".concat(t))}async searchProducts(t){return await this.request("/api/v1/products/search?q=".concat(encodeURIComponent(t)))}async getCart(){return await this.request("/api/v1/cart")}async addToCart(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return await this.request("/api/v1/cart/add",{method:"POST",body:JSON.stringify({product_id:t,quantity:e})})}async updateCartItem(t,e){return await this.request("/api/v1/cart/update/".concat(t),{method:"PUT",body:JSON.stringify({quantity:e})})}async removeFromCart(t){return await this.request("/api/v1/cart/remove/".concat(t),{method:"DELETE"})}async clearCart(){return await this.request("/api/v1/cart/clear",{method:"DELETE"})}async createOrder(t){let e={customer_name:t.customer_name,customer_email:t.customer_email,customer_phone:t.customer_phone,shipping_address:t.shipping_address,notes:t.notes||null,items:t.items.map(t=>({product_id:t.product_id,quantity:t.quantity,unit_price:parseFloat(t.price||t.unit_price)}))};return await this.request("/api/v1/orders/customer",{method:"POST",body:JSON.stringify(e)})}async getOrders(){return await this.request("/api/v1/orders")}async getOrder(t){return await this.request("/api/v1/orders/".concat(t))}async createPaymentOrder(t){return await this.request("/api/v1/payment/create-order",{method:"POST",body:JSON.stringify({order_id:t})})}async verifyPayment(t){return await this.request("/api/v1/payment/verify",{method:"POST",body:JSON.stringify(t)})}async initiatePayment(t){try{let e=await this.createOrder(t),r=await this.createPaymentOrder(e.id);return new Promise((n,a)=>{let o={key:"FVZPTn18225397949705",amount:r.amount,currency:r.currency,name:"Aशा - Grace Woven by Asha Dhaundiyal",description:"Handwoven Sarees & Traditional Wear",order_id:r.razorpay_order_id,handler:async t=>{try{let r=await this.verifyPayment({razorpay_order_id:t.razorpay_order_id,razorpay_payment_id:t.razorpay_payment_id,razorpay_signature:t.razorpay_signature});n({success:!0,order:e,payment:t,verification:r})}catch(t){a({success:!1,error:t.message})}},prefill:{name:t.customer_name||"",email:t.customer_email||"",contact:t.customer_phone||""},theme:{color:"#8B4513"},modal:{ondismiss:()=>{a({success:!1,error:"Payment cancelled by user"})}}};window.Razorpay?new window.Razorpay(o).open():a({success:!1,error:"Razorpay not loaded"})})}catch(t){throw t}}async subscribeNewsletter(t){return await this.request("/api/v1/newsletter/subscribe",{method:"POST",body:JSON.stringify({email:t})})}async submitContactForm(t){return await this.request("/api/v1/contact",{method:"POST",body:JSON.stringify(t)})}constructor(){this.baseURL=n,this.token=null}}let o=new a;e.Z=o},2445:function(){},6621:function(t){t.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}},8960:function(t){!function(){var e={229:function(t){var e,r,n,a=t.exports={};function o(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(r){try{return e.call(null,t,0)}catch(r){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(t){r=i}}();var c=[],u=!1,l=-1;function d(){u&&n&&(u=!1,n.length?c=n.concat(c):l=-1,c.length&&y())}function y(){if(!u){var t=s(d);u=!0;for(var e=c.length;e;){for(n=c,c=[];++l<e;)n&&n[l].run();l=-1,e=c.length}n=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function f(){}a.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new h(t,e)),1!==c.length||u||s(y)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=f,a.addListener=f,a.once=f,a.off=f,a.removeListener=f,a.removeAllListeners=f,a.emit=f,a.prependListener=f,a.prependOnceListener=f,a.listeners=function(t){return[]},a.binding=function(t){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},r={};function n(t){var a=r[t];if(void 0!==a)return a.exports;var o=r[t]={exports:{}},i=!0;try{e[t](o,o.exports,n),i=!1}finally{i&&delete r[t]}return o.exports}n.ab="//";var a=n(229);t.exports=a}()},622:function(t,e,r){"use strict";var n=r(2265),a=Symbol.for("react.element"),o=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function u(t,e,r){var n,o={},u=null,l=null;for(n in void 0!==r&&(u=""+r),void 0!==e.key&&(u=""+e.key),void 0!==e.ref&&(l=e.ref),e)i.call(e,n)&&!c.hasOwnProperty(n)&&(o[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps)void 0===o[n]&&(o[n]=e[n]);return{$$typeof:a,type:t,key:u,ref:l,props:o,_owner:s.current}}e.Fragment=o,e.jsx=u,e.jsxs=u},7437:function(t,e,r){"use strict";t.exports=r(622)}},function(t){t.O(0,[971,938,560],function(){return t(t.s=3600)}),_N_E=t.O()}]);