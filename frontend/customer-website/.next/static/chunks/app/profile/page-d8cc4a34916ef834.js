(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{9421:function(e,s,t){Promise.resolve().then(t.bind(t,4540))},4540:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return o}});var a=t(7437),r=t(2265),n=t(4033),i=t(4193),l=t(2201),d=t(4640),c=t(9487);function o(){var e,s;let t=(0,n.useRouter)(),{user:o,isLoading:m,refreshUser:x}=(0,d.useAuth)(),[u,h]=(0,r.useState)(!1),[p,g]=(0,r.useState)(!1),[b,f]=(0,r.useState)(!1),[y,j]=(0,r.useState)(!1),[w,N]=(0,r.useState)({type:"",text:""}),[v,_]=(0,r.useState)({first_name:"",last_name:"",username:"",email:"",phone:""}),[k,C]=(0,r.useState)({current_password:"",new_password:"",confirm_password:""}),[P,S]=(0,r.useState)({email_notifications:!0,sms_notifications:!1,newsletter:!0});(0,r.useEffect)(()=>{m||o||t.push("/")},[o,m,t]),(0,r.useEffect)(()=>{o&&_({first_name:o.first_name||"",last_name:o.last_name||"",username:o.username||"",email:o.email||"",phone:o.phone||""})},[o]);let E=async e=>{e.preventDefault(),j(!0),N({type:"",text:""});try{let e={first_name:v.first_name,last_name:v.last_name};v.phone&&v.phone.trim()&&(e.phone=v.phone),await c.Z.request("/api/v1/auth/me",{method:"PUT",body:JSON.stringify(e)}),await x(),N({type:"success",text:"Profile updated successfully!"}),h(!1),setTimeout(()=>N({type:"",text:""}),3e3)}catch(e){console.error("Profile update error:",e),N({type:"error",text:e.message||"Failed to update profile. Please try again."})}finally{j(!1)}},A=async e=>{if(e.preventDefault(),k.new_password!==k.confirm_password){N({type:"error",text:"New passwords do not match!"});return}if(k.new_password.length<8){N({type:"error",text:"Password must be at least 8 characters long"});return}j(!0),N({type:"",text:""});try{await c.Z.request("/api/v1/auth/change-password",{method:"POST",body:JSON.stringify({current_password:k.current_password,new_password:k.new_password})}),N({type:"success",text:"Password changed successfully!"}),C({current_password:"",new_password:"",confirm_password:""}),g(!1),setTimeout(()=>N({type:"",text:""}),3e3)}catch(e){console.error("Password change error:",e),N({type:"error",text:e.message||"Failed to change password. Please try again."})}finally{j(!1)}};return m?(0,a.jsxs)("div",{className:"min-h-screen bg-warm-white",children:[(0,a.jsx)(i.default,{}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"text-center py-16",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-beige-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-beige-600",children:"Loading profile..."})]})}),(0,a.jsx)(l.default,{})]}):o?(0,a.jsxs)("div",{className:"min-h-screen bg-warm-white",children:[(0,a.jsx)(i.default,{}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-serif text-primary-brown mb-2",children:"My Profile"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage your account information"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-brown-800 to-brown-700 px-6 py-8 text-white",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"w-20 h-20 bg-white/20 rounded-full flex items-center justify-center text-3xl font-serif",children:[null===(e=o.first_name)||void 0===e?void 0:e.charAt(0),null===(s=o.last_name)||void 0===s?void 0:s.charAt(0)]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-serif",children:[o.first_name," ",o.last_name]}),(0,a.jsxs)("p",{className:"text-white/80",children:["@",o.username]}),(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium mt-2 ".concat(o.is_verified?"bg-green-500":"bg-yellow-500"),children:o.is_verified?"✓ Verified":"Not Verified"})]})]})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("form",{onSubmit:E,children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),(0,a.jsx)("input",{type:"text",value:v.first_name,onChange:e=>_({...v,first_name:e.target.value}),disabled:!u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-beige-600 disabled:bg-gray-50 disabled:text-gray-600"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),(0,a.jsx)("input",{type:"text",value:v.last_name,onChange:e=>_({...v,last_name:e.target.value}),disabled:!u,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-beige-600 disabled:bg-gray-50 disabled:text-gray-600"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),(0,a.jsx)("input",{type:"text",value:v.username,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Username cannot be changed"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,a.jsx)("input",{type:"email",value:v.email,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),(0,a.jsx)("input",{type:"tel",value:v.phone,onChange:e=>_({...v,phone:e.target.value}),disabled:!u,placeholder:"+91 9999999999",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-beige-600 disabled:bg-gray-50 disabled:text-gray-600"})]})]}),(0,a.jsxs)("div",{className:"border-t pt-6 mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Account Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Account Type"}),(0,a.jsx)("p",{className:"font-medium text-gray-800 capitalize",children:o.role})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Member Since"}),(0,a.jsx)("p",{className:"font-medium text-gray-800",children:new Date(o.created_at).toLocaleDateString("en-IN",{month:"long",year:"numeric"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Account Status"}),(0,a.jsx)("p",{className:"font-medium ".concat(o.is_active?"text-green-600":"text-red-600"),children:o.is_active?"Active":"Inactive"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"User ID"}),(0,a.jsxs)("p",{className:"font-medium text-gray-800",children:["#",o.id]})]})]})]}),(0,a.jsx)("div",{className:"flex justify-end space-x-4",children:u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{type:"button",onClick:()=>{h(!1),_({first_name:o.first_name||"",last_name:o.last_name||"",username:o.username||"",email:o.email||"",phone:o.phone||""})},className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-6 py-2 bg-primary-brown text-white rounded-lg hover:bg-dark-brown transition-colors",children:"Save Changes"})]}):(0,a.jsx)("button",{type:"button",onClick:()=>h(!0),className:"px-6 py-2 bg-primary-brown text-white rounded-lg hover:bg-dark-brown transition-colors",children:"Edit Profile"})})]})})]}),w.text&&(0,a.jsx)("div",{className:"mt-6 p-4 rounded-lg ".concat("success"===w.type?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),children:w.text}),(0,a.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Security"}),(0,a.jsx)("button",{onClick:()=>g(!0),className:"text-primary-brown hover:underline text-sm font-medium",children:"Change Password →"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Preferences"}),(0,a.jsx)("button",{onClick:()=>f(!0),className:"text-primary-brown hover:underline text-sm font-medium",children:"Email Preferences →"})]})]}),p&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Change Password"}),(0,a.jsxs)("form",{onSubmit:A,children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),(0,a.jsx)("input",{type:"password",value:k.current_password,onChange:e=>C({...k,current_password:e.target.value}),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-beige-600"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),(0,a.jsx)("input",{type:"password",value:k.new_password,onChange:e=>C({...k,new_password:e.target.value}),required:!0,minLength:8,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-beige-600"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 8 characters"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),(0,a.jsx)("input",{type:"password",value:k.confirm_password,onChange:e=>C({...k,confirm_password:e.target.value}),required:!0,minLength:8,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-beige-600"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 mt-6",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{g(!1),C({current_password:"",new_password:"",confirm_password:""}),N({type:"",text:""})},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:y,className:"px-4 py-2 bg-primary-brown text-white rounded-lg hover:bg-dark-brown disabled:opacity-50",children:y?"Changing...":"Change Password"})]})]})]})}),b&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Email Preferences"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-800",children:"Email Notifications"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Receive order updates via email"})]}),(0,a.jsx)("input",{type:"checkbox",checked:P.email_notifications,onChange:e=>S({...P,email_notifications:e.target.checked}),className:"w-5 h-5 text-primary-brown"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-800",children:"SMS Notifications"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Receive SMS updates"})]}),(0,a.jsx)("input",{type:"checkbox",checked:P.sms_notifications,onChange:e=>S({...P,sms_notifications:e.target.checked}),className:"w-5 h-5 text-primary-brown"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-800",children:"Newsletter"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Get latest collections & offers"})]}),(0,a.jsx)("input",{type:"checkbox",checked:P.newsletter,onChange:e=>S({...P,newsletter:e.target.checked}),className:"w-5 h-5 text-primary-brown"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 mt-6",children:[(0,a.jsx)("button",{onClick:()=>f(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{N({type:"success",text:"Preferences saved successfully!"}),f(!1),setTimeout(()=>N({type:"",text:""}),3e3)},className:"px-4 py-2 bg-primary-brown text-white rounded-lg hover:bg-dark-brown",children:"Save Preferences"})]})]})})]}),(0,a.jsx)(l.default,{})]}):null}}},function(e){e.O(0,[922,640,809,971,938,560],function(){return e(e.s=9421)}),_N_E=e.O()}]);