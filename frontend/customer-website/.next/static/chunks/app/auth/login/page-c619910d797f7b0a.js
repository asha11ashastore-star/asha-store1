(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{4212:function(e,t,s){Promise.resolve().then(s.bind(s,4006))},4006:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var r=s(7437),a=s(2265),o=s(4033),l=s(4640),n=s(4193),i=s(2201);function d(){let e=(0,o.useRouter)(),{login:t}=(0,l.useAuth)(),[s,d]=(0,a.useState)(""),[c,m]=(0,a.useState)(""),[u,x]=(0,a.useState)(""),[h,b]=(0,a.useState)(!1),[g,p]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=sessionStorage.getItem("login_email");e&&(console.log("✅ Pre-filling email from session:",e),d(e),p(!0),sessionStorage.removeItem("login_email"))},[]);let f=async r=>{r.preventDefault(),x(""),b(!0);try{await t(s,c);let r=sessionStorage.getItem("redirect_after_login");r?(console.log("✅ Redirecting back to:",r),sessionStorage.removeItem("redirect_after_login"),e.push(r)):e.push("/")}catch(e){var a,o;x((null===(o=e.response)||void 0===o?void 0:null===(a=o.data)||void 0===a?void 0:a.detail)||"Invalid email or password")}finally{b(!1)}};return(0,r.jsxs)("div",{className:"min-h-screen flex flex-col bg-beige-50",children:[(0,r.jsx)(n.default,{}),(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center px-4 py-12",children:(0,r.jsx)("div",{className:"max-w-md w-full",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-serif text-primary-brown mb-2",children:"Welcome Back"}),(0,r.jsx)("p",{className:"text-gray-600",children:g?"Login to view your order":"Login to your account to continue shopping"})]}),g&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-amber-50 border-2 border-amber-400 rounded-lg",children:[(0,r.jsx)("p",{className:"text-sm text-amber-900 font-bold mb-2",children:"⚠️ IMPORTANT: Login with the correct email!"}),(0,r.jsx)("p",{className:"text-sm text-amber-800 font-semibold",children:"✅ Payment Successful!"}),(0,r.jsxs)("p",{className:"text-sm text-amber-700 mt-1",children:["Your order was placed with ",(0,r.jsx)("strong",{children:s})]}),(0,r.jsx)("p",{className:"text-sm text-amber-700 mt-1",children:"You MUST login with this email to see your order!"})]}),u&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,r.jsx)("p",{className:"text-sm text-red-800",children:u})}),(0,r.jsxs)("form",{onSubmit:f,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:["Email Address ",g&&(0,r.jsx)("span",{className:"text-amber-600",children:"(locked for your order)"})]}),(0,r.jsx)("input",{id:"email",type:"email",required:!0,value:s,onChange:e=>d(e.target.value),readOnly:g,disabled:g,className:"w-full px-4 py-3 border rounded-lg ".concat(g?"border-amber-400 bg-amber-50 cursor-not-allowed font-semibold text-amber-900":"border-gray-300 focus:ring-2 focus:ring-primary-brown focus:border-transparent"),placeholder:"you@example.com"}),g&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("p",{className:"text-xs text-amber-600 font-medium",children:"\uD83D\uDD12 This is the email used for your order. Cannot be changed."}),(0,r.jsx)("button",{type:"button",onClick:()=>{sessionStorage.removeItem("login_email"),sessionStorage.removeItem("redirect_after_login"),window.location.href="/auth/login"},className:"mt-2 text-xs text-primary-brown underline hover:text-brown-700",children:"Used wrong email? Click here to login with a different account"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,r.jsx)("button",{type:"button",onClick:()=>e.push("/auth/forgot-password"),className:"text-sm text-primary-brown hover:underline",children:"Forgot Password?"})]}),(0,r.jsx)("input",{id:"password",type:"password",required:!0,value:c,onChange:e=>m(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-brown focus:border-transparent",placeholder:"Enter your password"})]}),(0,r.jsx)("button",{type:"submit",disabled:h,className:"w-full bg-primary-brown text-white py-3 rounded-lg hover:bg-dark-brown transition-colors font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Logging in...":"Login"})]}),(0,r.jsx)("div",{className:"mt-6 text-center",children:(0,r.jsxs)("p",{className:"text-gray-600",children:["Don't have an account?"," ",(0,r.jsx)("button",{onClick:()=>e.push("/auth/signup"),className:"text-primary-brown hover:underline font-semibold",children:"Create Account"})]})}),(0,r.jsx)("div",{className:"mt-4 text-center",children:(0,r.jsx)("button",{onClick:()=>e.push("/"),className:"text-gray-600 hover:text-gray-800 text-sm",children:"← Back to Home"})})]})})}),(0,r.jsx)(i.default,{})]})}}},function(e){e.O(0,[922,640,809,971,938,560],function(){return e(e.s=4212)}),_N_E=e.O()}]);